# 實驗分析報告

**生成結果檔案**: `longmemeval_s_cleaned.json_retrievallog_turn_flat-stella.timefilteredgpt-4o_testlog_top50context_jsonformat_useronlyfalse_20251212-1054.jsonl.eval-results-gpt-4o-mini`

**參考答案檔案**: `longmemeval_s_cleaned.json`

**檢索結果檔案**: `longmemeval_s_cleaned.json_retrievallog_turn_flat-stella.timefilteredgpt-4o`

---

✓ 載入檢索結果: 500 個問題

================================================================================

--- 快速摘要（論文格式）---

--------------------------------------------------------------------------------

評估模型: gpt-4o-mini-2024-07-18

按任務類型的準確率:
  knowledge-update              : 0.7564 (78)
  multi-session                 : 0.3759 (133)
  single-session-assistant      : 0.5357 (56)
  single-session-preference     : 0.3000 (30)
  single-session-user           : 0.8571 (70)
  temporal-reasoning            : 0.3383 (133)

Task-averaged Accuracy: 0.5273
Overall Accuracy:       0.5060
Abstention Accuracy:    0.8667 (30)

================================================================================

--- 詳細分析報告 ---

--------------------------------------------------------------------------------
總樣本數: 500
平均準確率: 0.5060

================================================================================

--- [1] Retrieval Recall 分析 ---

--------------------------------------------------------------------------------
平均 Recall@5:  0.6523
平均 Recall@10: 0.7246
平均 Recall@50: 0.7814

[1.1] Recall@10 vs. 準確率
```
                       mean  count
recall_bin                        
Low (<0.5)         0.367347     49
Medium (0.5-0.99)  0.227273     22
Perfect (1.0)      0.533742    326
```


[1.2] 錯誤歸因分析（整體）
檢索失敗 (Recall < 1.0): 95 / 247 (38.5%)
推理失敗 (Recall = 1.0): 152 / 247 (61.5%)

[1.3] 按問題類型分解的 Recall 和錯誤歸因

完整統計表：
            question_type  count  accuracy  avg_recall@10  incorrect  retrieval_fail  retrieval_fail_%  reasoning_fail  reasoning_fail_%
         knowledge-update     78  0.756410       0.891026         19               2         10.526316              17         89.473684
            multi-session    133  0.375940       0.732456         83              37         44.578313              46         55.421687
 single-session-assistant     56  0.535714       0.071429         26              25         96.153846               1          3.846154
single-session-preference     30  0.300000       0.933333         21               2          9.523810              19         90.476190
      single-session-user     70  0.857143       0.871429         10               2         20.000000               8         80.000000
       temporal-reasoning    133  0.338346       0.769925         88              27         30.681818              61         69.318182

================================================================================

--- [2] 準確率 vs. 問題類型 ---

--------------------------------------------------------------------------------
```
                          is_correct       recall@10
                                mean count      mean
question_type                                       
knowledge-update            0.756410    78  0.891026
multi-session               0.375940   133  0.732456
single-session-assistant    0.535714    56  0.071429
single-session-preference   0.300000    30  0.933333
single-session-user         0.857143    70  0.871429
temporal-reasoning          0.338346   133  0.769925
```


================================================================================

--- [3] 位置偏差分析（僅 Single-Evidence 樣本）---

--------------------------------------------------------------------------------
Single-Evidence 樣本數: 176 / 500

[3.1] 準確率 vs. Evidence 位置
```
                 is_correct       recall@10
                       mean count      mean
pos_bin                                    
0-20% (Oldest)     0.724138    29  0.655172
20-40%             0.583333    36  0.638889
40-60%             0.480000    25  0.560000
60-80%             0.666667    39  0.564103
80-100% (Newest)   0.638298    47  0.659574
```


✓ 圖表已儲存: analysis_results/rag_with_time/position_bias_single_evidence.png

================================================================================

--- [4] Multi-Evidence 分析 ---

--------------------------------------------------------------------------------
Multi-Evidence 樣本數: 324 / 500

[4.1] 準確率 vs. Evidence 數量
```
               is_correct       evidence_span
                     mean count          mean
evidence_count                               
2                0.468000   250      0.401130
3                0.414634    41      0.476404
4                0.315789    19      0.672279
5                0.181818    11      0.636521
6                0.333333     3      0.543235
```


[4.2] 準確率 vs. Evidence 跨度
```
                        mean  count
span_bin                           
Small (<0.33)       0.403101    129
Medium (0.33-0.67)  0.479339    121
Large (>0.67)       0.445946     74
```


================================================================================

--- [5] Context Length 分析 ---

--------------------------------------------------------------------------------
```
            is_correct       recall@10
                  mean count      mean
history_bin                           
0-50          0.489899   396  0.722811
50-100        0.567308   104  0.731571
100-150            NaN     0       NaN
150-200            NaN     0       NaN
```


================================================================================
分析完成！

--------------------------------------------------------------------------------
